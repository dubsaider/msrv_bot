# Telegram Бот с Транскрипцией и Пользовательскими Ответами

Этот Telegram бот разработан на `aiogram` и предоставляет функциональность обработки текстовых, голосовых сообщений и видеозаметок ("кружочков"), включая транскрипцию аудио и уникальные текстовые реакции.

## Описание

Бот умеет:
  - Отвечать на определенные текстовые фразы.
  - Считать упоминания "Паша" в групповых чатах и автоматически отправлять благодарственное сообщение при достижении заданного порога.
  - Транскрибировать голосовые сообщения и видеозаметки, отправляя их во внешний API сервис для распознавания речи.

## Особенности
  - Обработка текстовых сообщений:
  - Автоматические ответы на заранее заданные ключевые фразы (конфигурируется в `constants/answers.py`).
  - Система учета упоминаний "Паша" (и его различных вариаций) в групповых чатах. При достижении порога (`PASHA_MENTION_THRESHOLD`) бот отправляет сообщение `#СпасибоПаша` и сбрасывает счетчик.
  - Транскрипция голосовых сообщений и видеозаметок:
  - Скачивает прикрепленные голосовые сообщения и видеозаметки.
  - Отправляет аудиоданные на внешний сервис транскрипции (URL конфигурируется через `TRANSCRIBE_API`).
  - Публикует полученный транскрибированный текст как цитату в чат.
  - Легкая развертывание: Проект готов к развертыванию с помощью Docker и Docker Compose.

## Требования

Для запуска бота вам понадобится:
  - `Docker` и `Docker Compose`
  - Токен Telegram бота (получается у `@BotFather`)
  - URL внешнего API сервиса для транскрипции аудио (например, API на базе Whisper).

## Установка и Запуск

Выполните следующие шаги для установки и запуска бота:

1.  Клонируйте репозиторий:
    ```bash
    git clone https://github.com/dubsaider/msrv_bot.git
    cd your-repo-name
    ```

2.  Создайте файл `.env`:
    Создайте файл с именем `.env` в корневой директории проекта и добавьте в него следующие переменные окружения:

    ```ini
    BOT_TOKEN=ВАШ_ТЕЛЕГРАМ_БОТ_ТОКЕН
    TRANSCRIBE_API=http://АДРЕС_ВАШЕГО_API_ТРАНСКРИПЦИИ:ПОРТ/transcribe
    ```
  - `BOT_TOKEN`: Токен, полученный от BotFather.
  - `TRANSCRIBE_API`: Полный URL вашего сервиса транскрипции. Убедитесь, что бот имеет доступ к этому адресу.

3.  Запустите бот с помощью Docker Compose:
    ```bash
    docker-compose up --build -d
    ```
  - `--build`: Собирает образ Docker, если он еще не создан или если изменения в Dockerfile.
  - `-d`: Запускает контейнер в фоновом режиме (detached mode).

Бот будет запущен и готов к работе. Вы можете проверить статус контейнера:
`bash
docker-compose ps
`

## Конфигурация

Вы можете настроить поведение бота, изменив следующие файлы:
  - `config.py`: Загружает переменные окружения.
  - `constants/answers.py`: Словарь `ANSWERS` для настройки пользовательских текстовых ответов.
    `python
    ANSWERS = {
        "да": "пизда",
        "net": "пидора ответ",
        # ... добавьте свои пары ключ-значение
    }
    `
  - `constants/pasha_mentions.py`:
  - `PASHA_MENTION_PATTERNS`: Список регулярных выражений для распознавания упоминаний "Паша".
  - `PASHA_MENTION_THRESHOLD`: Количество упоминаний, после которого сработает сообщение `#СпасибоПаша`.
  - `PASHA_THANKS_MESSAGE`: Текст сообщения, отправляемого при достижении порога.

## Использование

1.  Добавьте бота: Добавьте вашего бота в нужный групповой чат или начните личную переписку.
2.  Текстовые ответы: Отправляйте текстовые сообщения, содержащие фразы из `constants/answers.py`, чтобы получить ответ бота.
3.  Счетчик "Паша": В групповом чате набирайте "Паша" или его варианты. Как только количество упоминаний достигнет порога, бот автоматически отправит `#СпасибоПаша`.
4.  Транскрипция аудио: Отправляйте голосовые сообщения или видеозаметки ("кружочки"). Бот обработает их и пришлет транскрипцию.

## Структура Проекта

```
.
├── .dockerignore
├── .env                  # Переменные окружения (BOT_TOKEN, TRANSCRIBE_API)
├── config.py             # Загрузка конфигурации из .env
├── constants/            # Константы и настройки
│   ├── answers.py        # Настраиваемые текстовые ответы
│   └── pasha_mentions.py # Настройки счетчика "Паша"
├── docker-compose.yaml   # Конфигурация для Docker Compose
├── Dockerfile            # Инструкции для сборки Docker образа
├── handlers/             # Обработчики сообщений
│   ├── audio_handlers.py # Обработка голосовых сообщений и видеозаметок
│   ├── pasha_counter_handler.py # Логика счетчика "Паша"
│   └── text_handlers.py  # Обработка текстовых сообщений
├── main.py               # Точка входа в бота, регистрация обработчиков
├── requirements.txt      # Зависимости Python
└── services/
    └── transcription_service.py # Сервис для взаимодействия с API транскрипции
```

## Вклад в Проект

Если вы хотите внести свой вклад в проект, пожалуйста, следуйте стандартным рекомендациям по разработке:
1.  Сделайте форк репозитория.
2.  Создайте новую ветку для ваших изменений.
3.  Внесите изменения и протестируйте их.
4.  Отправьте pull-request с описанием ваших изменений.

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности смотрите в файле `LICENSE` (если применимо).

---